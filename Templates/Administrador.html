<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="icon" href="https://i.ibb.co/9Gy1hPQ/CARPOOL.png">
    <link rel="stylesheet" href="static/styles.css">
    <script src="static/script.js" defer></script>
    <script src="static/Script1.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.20.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="...">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha256-oP6HI/t1fWCf3I2uB2a0f50b6Dv0Y8dXFBW6AuF5+9Q=" crossorigin="anonymous"></script>

    <title>Administrador</title>
    <style>
        body {
            background-image: url('https://www.liderempresarial.com/wp-content/uploads/2022/05/UPQ.jpg');
            background-size: cover;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            justify-content: space-between;
        }

        .footer-divider {
            height: 30px;
            /* Puedes ajustar la altura según tus necesidades */
        }

        .modal-image {
            width: 180px;
            height: 180px;
            border-radius: 90%;
            object-fit: cover;
            position: relative;
            left: 90px;
            right: 80px;
        }
        .modal-content .modal-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
        }

        /* ESTILOS DEL FOOTER */
        .footer {
            position: fixed;
            left: 0;
            bottom: 0;
            width: 100%;
            background-color: #0a4275;
            color: white;
            text-align: center;
            padding: 10px 0;
        }

        .footer-container {
            background-color: #0a4275;
            /* Cambio de color */
            color: white;
            text-align: center;
            padding: 10px 0;
        }
        .font-weight{
            font-weight: bold;
        }
        footer {
            margin: 0;
            background: transparent;
        }

        /* ESTILOS DEL NAVBAR */
        .navbar-light .navbar-nav .nav-link:hover {
            background-color: #0a4275;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            border-radius: 6px;
        }

        .rating-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            /* Centra horizontalmente */
            justify-content: center;
            /* Centra verticalmente */
            background: #fff;
            padding: 25px 50px 35px;
            border-radius: 8px;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.05);
        }

        .rating-box header {
            font-size: 22px;
            color: #dadada;
            font-weight: 500;
            margin-bottom: 20px;
            text-align: center;
        }

        .rating-box .stars {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        .stars i {
            color: #e6e6e6;
            font-size: 35px;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .stars i.active {
            color: #ff9c1a;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light navbar-scroll py-2" style="background-color: #072846;">
        <!-- INICIO CONTAINER -->
        <div class="container-fluid">
            <!-- INICIO BUTTON -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button><!-- FIN BUTTON -->

            <!-- Navbar brand -->
            <a class="navbar-brand mt-2 mt-lg-0" href="#">
                <img src="https://calareo.ca/wp-content/uploads/2020/10/UPQ-logo.png" height="65">
            </a>
            <!-- ELEMENTOS A LA IZQUIERDA "HOME" -->
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                  <a class="nav-link text-white" href="/admin">Conductores</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="/AdminPasajeros">Pasajeros</a>
                </li>
            </ul><!-- FIN ELEMENTOS A LA IZQUIERDA -->
            <!-- ELEMENTOS A LA DERECHA -->
            <div class="ml-auto">
                <!-- Avatar -->
                <div class="dropdown">
                    <a class="dropdown-toggle d-flex align-items-center hidden-arrow" href="#" id="navbarDropdownMenuAvatar" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <img src="https://i.ibb.co/jvrQmyM/CARPOOL-CARDENAL.png" class="rounded-circle" height="60" alt="Avatar Image" loading="lazy"/>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownMenuAvatar">
                        <li>
                            <a class="dropdown-item" href="/logout">Cerrar Sesión</a>
                        </li>
                    </ul>
                </div>
            </div>            
        </div><!-- FIN CONTAINER -->
    </nav><!-- FIN NAVBAR -->
    <div class="mt-5 mb-5">
        <h1 class="display-1 text-center text-white">Control de Conductores</h1>
    </div>
    <div class="container text-center py-3">
        <div class="row justify-content-md-center">
            <div class="col ">
                <div class=" card card-body shadow border-1 bg-active">
                    <table class="table table-striped table-hover table-bordered table-shadow p">
                        <thead>
                            <H1>Registros de Rutas</H1>
                            <tr class="me-3 ms-5">
                                <th>Nombre de la Ruta</th>
                                <th>Nombre del Conductor</th>
                                <th>Opciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for cond in conductores %}
                            <tr class="me-3 ms-5">
                                <td>{{cond.0}}</td>
                                <td> {{cond.2}} </td>
                                <td>
                                    <button type="button" class="btn btn-outline-primary me-2" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight1{{ cond.3 }}" aria-controls="offcanvasRight"><i class="bi bi-person"></i>Perfil</button>
                                    <button type="button" class="btn btn-outline-primary me-2" data-bs-toggle="modal" data-bs-target="#exampleModal2{{loop.index}}"><i class="bi bi-info-circle"></i> Información</button>
                                    <button type="button" class="btn btn-outline-warning me-2" data-bs-toggle="modal" data-bs-target="#exampleModal4{{ cond.3 }}"><i class="bi bi-chat-square-text-fill"></i> Comentarios</button>
                                    <button class="btn btn-outline-success habilitar-btn">Habilitar Calificación</button>
                                    <button class="btn btn-outline-danger deshabilitar-btn">Deshabilitar Calificación</button>
                                    <div class="btn-group mt-2">
                                        <button type="button" class="btn btn-outline-primary  dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-check2-circle"></i>Action</button>
                                        <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#">Aprobado</a></li>
                                        <li><a class="dropdown-item" href="#">Rechazado</a></li>
                                        <li><a class="dropdown-item" href="#">En revisión</a></li>
                                        </ul>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <!--MODAL DEL PASAJERO-->
{% for cond in conductores %}
<div class="modal fade" id="exampleModal2{{loop.index}}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Registro</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="modal-body">
                    <h2>{{ cond[2] }} - Rutas Registradas</h2>
                    <table class="table table-hover table-bordered{{ cond.3 }}">
                        <thead class="table-primary">
                            <tr>
                                <th scope="col">Punto de Referencia</th>
                                <th scope="col">Descripción</th>
                                <th scope="col">Hora</th>
                                <!-- Agrega las columnas necesarias aquí -->
                            </tr>
                        </thead>
                        <tbody>
                            {% for parada in paradas %}
                                {% if cond.5 in parada %}
                                <tr>
                                    <td>{{ parada.1 }}</td>
                                    <td>{{ parada.2 }}</td>
                                    <td>{{ parada.3 }}</td>
                                </tr>
                                {% endif %}
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <h1 class="modal-title fs-5" id="exampleModalLabel">Documentación</h1>
            
                <!-- Columna de enlaces -->
                {% set matricula = cond.3 %}

                <div>
                    {% set ruta_archivo_INE = url_for('static', filename='archivos/' + matricula + '_Credencial_INE.pdf') %}
                    <a href="{{ ruta_archivo_INE }}" target="_blank">{{ matricula }} - Credencial INE</a>
                </div>
                
                <div>
                    {% set ruta_archivo_UPQ = url_for('static', filename='archivos/' + matricula + '_Credencial_UPQ.pdf') %}
                    <a href="{{ ruta_archivo_UPQ }}" target="_blank">{{ matricula }} - Credencial UPQ</a>
                </div>
                
                <div>
                    {% set ruta_archivo_Poliza = url_for('static', filename='archivos/' + matricula + '_gdggd_Poliza.pdf') %}
                    <a href="{{ ruta_archivo_Poliza }}" target="_blank">{{ matricula }} - Póliza</a>
                </div>
                
                <div>
                    {% set ruta_archivo_Tarjeta = url_for('static', filename='archivos/' + matricula + '_gdggd_Tarjeta_Circulacion.pdf') %}
                    <a href="{{ ruta_archivo_Tarjeta }}" target="_blank">{{ matricula }} - Tarjeta de Circulación</a>
                </div>
                
                <!-- Imagen del vehículo -->
                {% set ruta_imagen = url_for('static', filename='archivos/' + matricula + '_gdggd_Foto_Vehiculo.jpg') %}
                <img src="{{ ruta_imagen }}" alt="{{ matricula }} - Foto de vehículo" class="img-fluid mt-3">
                
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-warning" data-bs-dismiss="modal"><i class="bi bi-arrow-return-left"></i> Cerrar</button>
            </div>
        </div>
    </div>
</div>

{% endfor %}


    <!--SIERRE DE MODAL-->
    <!--ES PARA MOSTAR EL PERFIL-->
    {% for cond in conductores1 %}
        
        <div class="offcanvas offcanvas-end" tabindex="-2" id="offcanvasRight1{{ cond.3 }}" aria-labelledby="offcanvasRightLabel">
            <div class="offcanvas-header">
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
                <img src="/static/archivos/{{ cond.3 }}_Foto_Personal.jpg" alt="Imagen de usuario" class="modal-image">
                <h5 class="modal-title p-3 text-center" id="modalConductorLabel{{ cond.id }}">{{ cond.2 }}</h5>
                <div class="container">
                    <div class="row">
                        <form class="row py-2" action="#">
                            <div class="col-6 p-2">
                                <label for="Idnombre" class="font-weight">Matricula:</label>
                                <label for="Idnombre">{{ cond.3 }}</label>
                            </div>
                            <div class="col-6 p-2">
                                <label for="Idnombre" class="font-weight">Telefono:</label>
                                <label for="Idnombre">{{ cond.7 }}</label>
                            </div>
                            <div class="col-6 p-2">
                                <label for="Idnombre" class="font-weight">Sexo:</label>
                                <label for="Idnombre">{{ cond.5 }}</label>
                            </div>
                            <div class="col-6 p-2">
                                <label for="Idnombre" class="font-weight">Carrera:</label>
                                <label for="Idnombre">{{ cond.4 }}</label>
                            </div>
                            <div class="col-6 p-2">
                                <label for="Idnombre" class="font-weight">Correo Institusional:</label>
                                <label for="Idnombre">{{ cond.6 }}</label>
                            </div>
                        </form>
                    </div>
                    
                </div>
            </div>
            <div class="offcanvas-footer container">
                <div class=" gap-2 py-3 text-center">
                    <button type="button" class="btn btn-danger"><i class="bi bi-person-x"></i> Dar de Baja</button>
                    <button type="button" class="btn btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close"><i class="bi bi-arrow-return-left"></i> Regresar</button>
                </div>
            </div>
        </div>
    {% endfor %}
    {% for cond in conductores %}
    <!--MODAL DEL CONDUCTOR COMENTARIOS-->
    <div class="modal fade" id="exampleModal4{{ cond.3 }}" tabindex="-1" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Comentarios {{ cond.3 }}</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form method="post" action="/enviar_comentario">
                        <input type="hidden" name="conductor_id" value="{{ cond.3 }}">
                        <div class="mb-3">
                            <label for="message-text" class="col-form-label">Ingrese su Comentario:</label>
                            <textarea class="form-control" id="message-text-{{ cond.3 }}" name="message-text"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary"><i class="bi bi-cursor-fill"></i> Enviar Comentario</button>
                    </form>
                    
                    <h1 class="modal-title fs-5 mt-3 text-center" id="exampleModalLabel">Comentarios Enviados</h1>
                    
                    <table class="table table-bordered mt-3">
                        <thead>
                            <tr class="text-center">
                                <th></th>
                                <th>Comentarios</th>
                                <th>Opciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for comentario in comentarios_por_conductor[cond.3] %}
                                <tr class="text-center">
                                    <td>{{comentario[0]}}</td>
                                    <td>{{ comentario[1] }}</td>
                                    <td class="text-center">
                                        <form method="post" action="/eliminar_comentario">
                                            <input type="hidden" name="comentario_id" value="{{ comentario[0] }}">
                                            <button type="submit" class="btn btn-outline-danger"><i class="bi bi-trash"></i> Eliminar</button>
                                        </form>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <h1 class="modal-title fs-5 mt-3 text-center" id="exampleModalLabel">Comentarios Finales del Viaje</h1>
                    <table class="table table-bordered mt-3">
                        <tr>
                            <th class="text-center">Comentarios</th>
                        </tr>
                        <tr>
                            <td>ldjggljdslfg</td>
                        </tr>
                    </table>
                                         
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-warning" data-bs-dismiss="modal"><i class="bi bi-arrow-return-left"></i> Cerrar</button>
                </div>
            </div>
        </div>
    </div>
{% endfor %}

    <!--CIERRE DE MODAL-->
</div>

<!-- Agrega esto antes de tu script -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Agrega este script al final de tu archivo HTML o en un archivo JavaScript separado -->
<script>
    // Función para establecer la cookie con el estado
    function setEstadoBotonCalificaciones(estado) {
        document.cookie = "estadoBotonCalificaciones=" + estado;
    }

    // Función para habilitar el botón
    function habilitarBotonCalificaciones() {
        setEstadoBotonCalificaciones("habilitado");
        $('#btnCalificaciones').removeClass('disabled');
    }

    // Función para deshabilitar el botón
    function deshabilitarBotonCalificaciones() {
        setEstadoBotonCalificaciones("deshabilitado");
        $('#btnCalificaciones').addClass('disabled');
    }

    // Asigna eventos a los botones en la vista de Administrador
    $(document).ready(function() {
        $('.habilitar-btn').click(function() {
            habilitarBotonCalificaciones();
        });

        $('.deshabilitar-btn').click(function() {
            deshabilitarBotonCalificaciones();
        });
    });
</script>



    <!-- INICIO FOOTER -->
    <footer class="text-center text-white" style="background-color: #0a4275;">
        <div class="container p-4 pb-0"><!-- INICIO CONTAINER -->
            <section class="mb-4"><!-- INICIO SECTION -->
            <!-- Facebook -->
            <a class="btn btn-outline-light btn-floating m-1" href="https://es-la.facebook.com/UPQoficial/" role="button"><i class="fab fa-facebook-f"></i></a>

            <!-- Twitter -->
            <a class="btn btn-outline-light btn-floating m-1" href="https://twitter.com/UPQoficial" role="button"><i class="fab fa-twitter"></i></a>

            <!-- Google -->
            <a class="btn btn-outline-light btn-floating m-1" href="https://www.upq.mx/" role="button"><i class="fab fa-google"></i></a>

            <!-- Instagram -->
            <a class="btn btn-outline-light btn-floating m-1" href="https://www.instagram.com/soyupq/" role="button"><i class="fab fa-instagram"></i></a>
            </section><!-- FIN SECTION -->
        </div><!-- FIN CONTAINER -->
        <!-- Copyright -->
        <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
        © 2020 Copyright:
        <a class="text-white" href="/">CARPOOL CARDENAL</a>
        </div><!-- Copyright -->
    </footer><!-- FIN FOOTER -->

</body>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!--ADMINISTRADOR-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="sweetalert2.all.min.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
 <!-- INICIO SCRIPTS -->
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
 <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
 <script src="sweetalert2.all.min.js"></script>
 <!-- FIN SCRIPTS -->
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="..."></script>
 <script src="https://code.jquery.com/jquery-3.6.4.slim.min.js" integrity="..."></script>
 <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="..."></script>
</html>